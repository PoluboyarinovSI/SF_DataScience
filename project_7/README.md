# Проект 7. Создание модели для обнаружения мошеннических транзакций по кредитным картам

## Оглавление
[1. Описание проекта](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Описание-проекта)   
[2. Какой кейс решаем?](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Какой-кейс-решаем)   
[3. Краткая информация о данных](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Краткая-информация-о-данных)   
[4. Этапы работы над проектом](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Этапы-работы-над-проектом)   
[5. Результат](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Результат)  
[6. Выводы](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Выводы)   

## Описание проекта
Построить модель классификации банковских транзакций по кредитным картам для целей обнаружения мошеннических операций.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Какой кейс решаем?
Платежное мошенничество или мошенничество с платежами дистанционного банковского обслуживания - один из видов банковского мошенничества с банковскими картами, когда мошенник осуществляет платежи по карте без ведома владельца. Выявление мошенничества с платежами - это комплекс мер, направленных на обнаружение различных рисков мошенничествао с платежами, которые могут нанести ущерб. Одним из наиболее эффективных инструментов для этого является машинное обучение. Необходимо создать модель машинного обучения для обнаружения и предотвращения мошеннических транзакций. 


**Метрика качества**   
В задачах, связанных с обнаружением высокого риска, метрика полноты (Recall) является более важным показателем оценки, чем точность (Accuracy). В случае обнаружения мошеннических операций с кредитными картами стоит задача максимально избежать ложных срабатываний. Мошеннические операции наносят большой ущерб. Ложноотрицательный случай в данном контексте означает, что мошенническая транзакция оценивается как обычная, что наносит ущерб. Поэтому ложные срабатывания не так важны, как предотвращение мошенничества.
Полнота рассчитывается как отношение числа Positive выборок, корректно классифицированных как Positive, к общему количеству Positive семлов. Полнота измеряет способность модели обнаруживать выборки, относящиеся к классу Positive. Чем выше метрика полноты, тем больше Positive семплов было обнаружено моделью.
Таким образом для оценки качества модели — качества классификации, выполненной моделью, — используется метрика полноты (Recall). В рамках оценки качества моделей необходимо стремиться к максимизации принятой метрики.

**Что практикуем**   
- Предобработку и очистку данных, создание новых признаков и манипуляции над таблицами.
- Разведывательный анализ данных, включая статистику.
- Решение задачи обучения с учителем: классификация.
- Валидация моделей и оценка качества.
- Вывод модели в продакшн.


### Краткая информация о данных
В качестве исходных данных использован смоделированный набор данных о транзакциях по кредитным картам, содержащий законные и мошеннические транзакции за период с 1 января 2019 года по 31 декабря 2020 года. Набор данных охватывает кредитные карты 1000 клиентов, совершающих транзакции с пулом из 800 продавцов. Данные были взяти из Kaggle по ссылке: https://www.kaggle.com/datasets/kartik2112/fraud-detection?select=fraudTrain.csv. Общий объем: 501.5+ MB.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Этапы работы над проектом
- Базовый анализ и знакомство с данными
- Первичная обработка данных
- Разведовательный анализ данных (EDA)
- Преобразование и создание и отбор признаков
- Создание и обучение моделей

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Результат   
Результаты о проделанной работе представлены в нескольких частях:
- Отчет по выполненой предобработке и разведовательном анализе данных (EDA) в Jupyter NoteBook (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/Project-7_EDA.ipynb)
- Отчет по созданию модели машинного обучения в Jupyter NoteBook (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/Project-7_Modeling.ipynb)
- Реализация модели в продакшене в виде веб-сервиса (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/web)

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Выводы
В рамках выполнения данного проекта была осуществлена RFM-сегментация клиентов, представленных в наборе данных. Для всех клиентов определены показатели Recency, Frequency, Monetary. Выполнено снижение размерности данных до 2-ух компонент методами PCA (метод главных компонент) и t-SNE. Для каждого из методов понижения размерности построены модели кластеризации с использованием алгоритмов Kmeans, EM-алгоритма (GaussianMixture), алгомеративной кластеризации (AgglomerativeClustering). Наилучший показатель целевой метрики достигла модель алгомеративной кластеризации для данных, понижение размерности для которых выполненно методом t-SNE. В результате кластеризации было сформировано 7 кластеров. Затем для целей предсказания кластера клиентов, которые не попали в обучающий набор данных, построена модель кластеризации. Проблема t-SNE заключается в том, что алгоритм непараметрический. Это значит, что он, в отличие от таких алгоритмов, как PCA и SVD, не создаёт явной функции отображения. Проще говоря, алгоритм трансформирует пространство признаков для обучающей выборки, но не запоминает, каким образом это делает. Это значит, что, передав в алгоритм новые объекты для сжатия пространства, мы получим абсолютно новое представление пространства, не имеющее отношения к тому, что мы построили для обучающей выборки. То есть произойдёт искажение, что может привести к неверным результатам кластеризации. В результате выполненой кластеризации появились истинные метки кластеров, а есть клиенты, которые описываются RFM-характеристиками. В целях предсказания кластера обучена модель, которая на основе RFM-характеристик будет предсказывать клиентский кластер. Целевой метрикой при оценке моделей классификации на RFM-метках использован показатель accuracy. Наилучшей показатель показа модель градиентного бустинга. Как результат получена модель, которая на основании RFM-меток новых клиентов может предсказать кластер клиентов в соответствии с принятой кластеризацией.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами