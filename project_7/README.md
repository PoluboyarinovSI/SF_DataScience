# Проект 7. Создание модели для обнаружения мошеннических транзакций по кредитным картам

## Оглавление
[1. Описание проекта](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Описание-проекта)   
[2. Какой кейс решаем?](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Какой-кейс-решаем)   
[3. Краткая информация о данных](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Краткая-информация-о-данных)   
[4. Этапы работы над проектом](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Этапы-работы-над-проектом)   
[5. Результат](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Результат)  
[6. Выводы](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Выводы)   

## Описание проекта
Построить модель классификации банковских транзакций по кредитным картам для целей обнаружения мошеннических операций.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Какой кейс решаем?
Платежное мошенничество или мошенничество с платежами дистанционного банковского обслуживания - один из видов банковского мошенничества с банковскими картами, когда мошенник осуществляет платежи по карте без ведома владельца. Выявление мошенничества с платежами - это комплекс мер, направленных на обнаружение различных рисков мошенничествао с платежами, которые могут нанести ущерб. Одним из наиболее эффективных инструментов для этого является машинное обучение. Необходимо создать модель машинного обучения для обнаружения и предотвращения мошеннических транзакций. 


**Метрика качества**   
В задачах, связанных с обнаружением высокого риска, метрика полноты (Recall) является более важным показателем оценки, чем точность (Accuracy). В случае обнаружения мошеннических операций с кредитными картами стоит задача максимально избежать ложных срабатываний. Мошеннические операции наносят большой ущерб. Ложноотрицательный случай в данном контексте означает, что мошенническая транзакция оценивается как обычная, что наносит ущерб. Поэтому ложные срабатывания не так важны, как предотвращение мошенничества.
Полнота рассчитывается как отношение числа Positive выборок, корректно классифицированных как Positive, к общему количеству Positive семлов. Полнота измеряет способность модели обнаруживать выборки, относящиеся к классу Positive. Чем выше метрика полноты, тем больше Positive семплов было обнаружено моделью.
Таким образом для оценки качества модели — качества классификации, выполненной моделью, — используется метрика полноты (Recall). В рамках оценки качества моделей необходимо стремиться к максимизации принятой метрики.

**Что практикуем**   
- Предобработку и очистку данных, создание новых признаков и манипуляции над таблицами.
- Разведывательный анализ данных, включая статистику.
- Решение задачи обучения с учителем: классификация.
- Валидация моделей и оценка качества.
- Вывод модели в продакшн.


### Краткая информация о данных
В качестве исходных данных использован смоделированный набор данных о транзакциях по кредитным картам, содержащий законные и мошеннические транзакции за период с 1 января 2019 года по 31 декабря 2020 года. Набор данных охватывает кредитные карты 1000 клиентов, совершающих транзакции с пулом из 800 продавцов. Данные были взяти из Kaggle по ссылке: https://www.kaggle.com/datasets/kartik2112/fraud-detection?select=fraudTrain.csv. Общий объем: 501.5+ MB.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Этапы работы над проектом
- Базовый анализ и знакомство с данными
- Первичная обработка данных
- Разведовательный анализ данных (EDA)
- Преобразование и создание и отбор признаков
- Создание и обучение моделей

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Результат   
Результаты о проделанной работе представлены в нескольких частях:
- Отчет по выполненой предобработке и разведовательном анализе данных (EDA) в Jupyter NoteBook (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/Project-7_EDA.ipynb)
- Отчет по созданию модели машинного обучения в Jupyter NoteBook (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/Project-7_Modeling.ipynb)
- Реализация модели в продакшене в виде веб-сервиса, размещенная на DockerHub и доступная для скачивания pranons/fraud_detection_image (https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/web)

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


### Выводы
В рамках вполнения данного проекта была реализована модель классификации транзакций по кредитным картам для обнаружения среди них мошеннических. В качестве исходных данных был использован смоделированный набор данных о транзакциях по кредитным картам, содержащий законные и мошеннические транзакции за период с 1 января 2019 года по 31 декабря 2020 года. Данные были предварительно обработаны, был выполнен разведовательный анализ данных, в рамках которого было установлено, что процент мошеннических транзакций от общего количества транзакций составляет 0,58%, средний возвраст владельцев карт, подвергщихся, мошенничеству составляет 48 лет и превышает средний возвраст владельцев карт для законных транзакций. Наибольший процент мошеннических транзакций с точки зрения месяца наблюдается в фервале, с точки зрения дня недели - в пятницу, с точки зрения времени суток с 22 до 3 часов. Наиболее значимыми признаками являются сумма транзакции, категория транзакции, временные характеристики транзакции. 
В ходе построения и обучения моделей классификации было построено три типа моделей: логистическая регрессия, дерево решений и случайный лес. Кроме того, в целях исключения негативного влияния на результат моделей было реализовано три метода борьбы с дисбалансом данных: Random Under Sampling, Random Over Sampling, SMOTE Over Sampling. Также была построена модель классификации с помощью библиотеки CatBoost. 

Таким образом, было построено 18 различных моделей. Из всех построенных моделей по показателю целевой метрики (Recall) наилучшими являются "DecisionTreeClassifier / Random Under Sampled" и "CatBoostClassifier / Random Under Sampled data". 
В качестве итоговой модели выбрана модель "CatBoostClassifier / Random Under Sampled data", показатель Recall для которой составляет 0.975, а показатель F1-score составляет 0.984.

:arrow_up[к оглавлению](https://github.com/PoluboyarinovSI/SF_DataScience/tree/main/project_7/README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами